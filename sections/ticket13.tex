\section{PDQ-разложение. Разложение обратимой матрицы в произведение элементарных}
\begin{theorem2}
    Пусть $K$ - поле, $A \in M(m, n, K)$.

    Тогда существуют элементы 
    $P_1, \dots, P_s, Q_1, \dots, Q_t \; (s,t \geqslant 0)$, такие, что 
    $P_s \dots P_1 \cdot A \cdot Q_1 \dots Q_t$ - окаймленная единичная матрица

    \begin{proof}
        Мы знаем, что матрицу можно превратить в ступенчатую с помощую элементарных преобразований строк.
        Интерпретируем этот факт следующим образом: 

        $A \in M(m, n, K) \Longrightarrow \exists P_1, \dots, P_s \in M(m, K)$ - элементарные матрицы, такие, что 
        $P_s \dots P_2 \cdot P_1 \cdot A$ - ступенчатая матрица

        ``Двигаемся дальше''

        Теперь заметим, что, используя элементарные преобразования строк, мы можем не только 
        сделать из матрицы ступенчатую, но и сделать так, чтобы ведущие элементы всех строк были единицами

        Теперь, используя элементарные преобразования столбцов, давайте занулим все элементы первой строки кроме 
        ведущего. Так поступим для всех ненулевых строк. На данном этапе будет получаться матрица,
        у которой в ненулевых строках есть единичка на какой-то позиции, при этом у строк ниже, чем эта, единичка стоит правее.

        Наконец теперь попереставляем столбцы местами и выставим столбцы таким образом, чтобы 
        получилась матрица вида
        $\begin{pmatrix}
            E_r & 0 \\
            0 & 0
        \end{pmatrix} \in M(m, n, K), \; 0 \leqslant r \leqslant min(m, n)$ - это и есть окаймленная 
        единичная матрица.
    \end{proof}
\end{theorem2}

\follow \; $K$ - поле, $A \in M(m, n, K)$, тогда $A$ можно представить в виде $A = PDQ$, где
$P \in GL(m, K), Q \in GL(n, K), D = \begin{pmatrix}
    E_r & 0 \\
    0 & 0
\end{pmatrix}$, при этом $P, Q$ - произведения элементарных матриц.
\begin{proof}
    $P_t \dots P_1 \cdot A \cdot Q_1 \dots Q_s = \begin{pmatrix}
        E_r & 0 \\
        0 & 0
    \end{pmatrix} = D \Longrightarrow A = P^{-1}_1 \dots P^{-1}_t D Q^{-1}_s Q^{-1}_{s-1} \dots Q^{-1}_{1}$

    Легко видеть, что матрицы, обратные к элементарным, сами являются элементарными

    $S^{-1}_{ij} = S_{ij} \quad D^{-1}_{ij}(\varepsilon) = D_{ij}(\varepsilon^{-1}) \quad T^{-1}_{ij}(\lambda) = T_{ij}(-\lambda)$

    Значит равенство $A = P^{-1}_1 \dots P^{-1}_t D Q^{-1}_s Q^{-1}_{s-1} \dots Q^{-1}_{1}$ мы можем записать 
    как $A = PDQ$
\end{proof}
\
\notice Обратимая матрица всегда является произведением элементарных матриц (докажем чуть позже)

\

\follow \; $A \in M(m, n, K) \; A = P_t \dots P_1 \cdot D \cdot Q_1 \dots Q_s, \quad P_i, Q_j $ - элементарные матрицы, $D = \begin{pmatrix}
    E_r & 0 \\
    0 & 0
\end{pmatrix}$

Тогда: $A \in GL(n, K) \Longleftrightarrow r = n$

\begin{proof} \quad

    \begin{itemize}
        \item[``$\Longleftarrow$'':] $D = E_n \\
            A = P_t \dots P_1 Q_1 \dots Q_s \in GL(n, k)$
        \item[``$\Longrightarrow$'':] $A$ - обратима. Тогда $D = P^{-1}_1 \dots P^{-1}_t A Q^{-1}_s Q^{-1}_{s-1} \dots Q^{-1}_{1} \in GL(n, k)$
            
            Если $r < n$, то последняя строка $D$ нулевая. Противоречие.
    \end{itemize}
\end{proof}

\follow \; $A \in M(n, K)$

Тогда: $A \in GL(n, K) \Longleftrightarrow A$ - произведение элементарных матриц.

\begin{proof} \quad

    \begin{itemize}
        \item[``$\Longleftarrow$'':] Элементарные обратимы
        \item[``$\Longrightarrow$'':] Пишем $PDQ$ разложение, $D = E_n$
        
        $A = PQ, \quad P, Q$ - произведение элементарных матрицы
    \end{itemize}
\end{proof}
