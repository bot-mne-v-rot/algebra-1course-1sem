% !TEX root = ../LinalColloc02.tex
\section{Простейшие дроби. Разложение правильной дроби в сумму простейших}
\begin{theorem-non}
    Любую правильную дробь можно единственным образом представить в виде суммы нескольких ненулевых правильных $p$-примарных дробей, 
    где $p$ -- различные унитарные неприводимые многочлены.
\end{theorem-non}

\begin{proof}
    Запишем знаменатель дроби $s$ в каноническом виде $p_1^{m_1} \dots p_t^{m_t}$ и применим предыдущую лемму $t - 1$ раз. 
    Тогда мы получим \[ s = \frac{a_1}{p_1^{m_1}} + \dots + \frac{a_t}{p_t^{m_t}} \]
    Записав каждое слагаемое в виде суммы многочлена и правильной дроби, мы получим представление
    \[ s = f + \frac{b_1}{p_1^{m_1}} + \dots + \frac{b_t}{p_t^{m_t}}, \]
    где $f$ -- некоторый многочлен, а остальные слагаемые -- правильные дроби. 
    Но тогда $f$ сам является правильной дробью (как разность правильных дробей), и тем самым $f = 0$.

    Докажем единственность такого представления. 
    Предположим, что у $s$ есть два разных представления в виде суммы правильных примарных дробей. 
    Вычтем из одного представления другое и оставим только ненулевые слагаемые (в несократимом виде):
    \begin{gather*}
        \frac{c_1}{p_1^{n_1}} + \dots + \frac{c_l}{p_l^{n_l}} = 0 \\
        \frac{c_1}{p_1^{n_1}} + \dots + \frac{c_{l - 1}}{p_{l-1}^{n_{l - 1}}} = \frac{-c_l}{p_l^{n_l}}
    \end{gather*}
    Выполнив сложение в левой части и сократив числитель и знаменатель полученной дроби на их НОД, мы получим несократимую дробь,
    знаменатель которой делит $p_1^{n_1} \dots p_{l - 1}^{n_{l - 1}}$ и не может быть ассоциирован с $p_l^{n_l}$ (как минимум потому что не делит $p_l$).
    
\end{proof}